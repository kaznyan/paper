# Ensemble Feature for Person Re-Identification

## 甲斐コメント

要はアンサンブル強いよねって話で終わってしまった

ただし、

- アンサンブルの場合でも計算量を少なくする工夫
- ちゃんと各アンサンブルモデルの性質を変える工夫

については参考になる部分がありそう。



## Abstract

EnsembleNet：テスト段階においても頑健な新しいアンサンブルネットワーク

- 単一のネットワークを複数のエンドツーエンドのブランチに分割
- アンサンブル特徴は、人を表すために各枝特徴を連結することによって得られる
- ResNet-50に基づいて設計
- 各バックボーンは計算量とメモリコストを節約するためのほとんどのパラメータを共有
- 個人識別タスク (パブリックMarket1501、DukeMTMC-reID、CUHK03) でSOTA



## 1. Introduction

re-ID：人物と異なるカメラ画像を一致させることを目的とする

問題点：トレーニングとテストの間には一般化の大きなギャップがある

- テストサンプルはまだトレーニングラベルに属すると考えてよい
- 実際の人物のラベルはトレーニングセットにない



→単一のCNNネットワークでは1つの特徴ベクトルしか抽出できない

→単純なアンサンブルで結果は向上するが不便かつ時間がかかる



提案：新しいアンサンブルモデル

- 複数の目的を形成するために複数のブランチを作成
- 各ブランチで異なる部分ベースモデルを使用

貢献：

- EnsembleNetを提案
  - ResNet-50に基づく
  - 複数のブランチで構成
  - 各ブランチから抽出された特徴を連結して各画像の特徴を形成
  - 複数の独立したネットワークを融合するよりもパラメータと計算が少ない

- ストライドサイズ、ブランチ数、および適応平均プーリングの効果を調べた
- 3つのre-IDベンチマークでSOTA
- 「フィルタ正規化」を用いてテストパフォーマンスを明らかにする
  - 「2次元損失ランドスケープの可視化手法」に似ているらしい。知らんけど



## 2. Related Work

たいしたことない



## 3. EnsembleNet

#### 3.1 三つの原則

計算効率と表現能力を向上するため、次の3つ（大嘘）の原則に従う

- 複数の分岐の開始点を慎重に選択する
- 分岐の数が十分
- 特徴は意味レベルの表現能力を持つ
- 特徴の次元は低く、容易に併合できる
- ブランチは互いに異なっている

この原則に基づき、各ブランチについて、

- 前半をパラメータ共有サブネットワークとする
- 後半を複数のブランチとする

→多様性と計算コストのトレードオフとして、ブランチの開始位置とブランチの数がキー

#### 3.2 Architecture

![キャプチャ](画像\キャプチャ.PNG)

- Divisionモジュール：

  - ダウンサンプリング操作があるres_conv 5_1層から派生してN個のブランチに分割

- adaptive average pooling (AAP) モジュール：

  - 異なるブランチに対して異なるプール操作を設定

    ：n番目のブランチはn個の特徴ベクトルを抽出するようにする

    　（≒人物の局所的な局所部分を表すための特徴ベクトルの数が異なる）

    - 1番目：GAPを使用して1つの特徴ベクトルを取得

    - 2番目：AAPを使用して2つの垂直特徴ベクトルを取得

    - 3番目：2D_AAPを使用して3つの垂直特徴ベクトルを取得

      …

- Reductionモジュール：

  - バッチ正規化、Leaky ReLU、1×1 Conv でチャネル数を2048-dimから256-dimに減らす

- Objectiveモジュール

  - Flatにするための1x1 Convを使用
  - Log Softmax Loss で誤差を計算



## 4. Experiments

#### 4.1 ベンチマーク

Market, CUHK, DukeでSOTA



## 4.2 Ablation

必要な時に読む



## 5. Explanation of effectiveness

「極小値が複数ある場合、目的の極小値の平坦度を広げる」

→EnsemleNetには複数の目的と損失があり、複数の最小値に達する可能性があるため、汎化にたける可能性がある



## 6. Coclusion

EnsembleNet

- ResNet-50に基づく
- 複数のブランチから抽出された特徴を歩行者の最終的な表現として連結
- 3つの大規模なre-IDデータセットにでSOTA
# Res2Net: A New Multi-scale Backbone Architecture

## 甲斐コメント

今後のBackbornの代表格になるかもしれない、めっちゃ良い感じのアーキテクチャ。

Residual Blockの畳み込み部分をさらにresidualっぽい構造にしてみたら組み合わせ数めっちゃ多くなってマルチスケールになったよ！

ってそりゃそうなんだけど計算量をほとんど増やさないで実現してるのが良いところ。

ついでに冷凍ビーム耐えるようになったよ！（嘘）

コード公開予定！　続報を待て！




## Abstruct

画像認識の問題において、複数のスケールで特徴を表現するが重要

→Backbone CNNの進歩によりマルチスケール表現能力が向上

　→幅広いアプリケーションで一貫したパフォーマンスの向上



既存の手法

- マルチスケール特徴を層状に表現する



提案手法：Res2Net

- 1つの残差ブロック内に階層的な残差のような接続を構築する、CNN用の新しいビルディングブロック

  →マルチスケール特徴をきめ細かいレベルで表す

  　→各NW層の受容的領域を広げる

- ResNet、ResNeXt、およびDLAのような最先端のBackbone CNNに接続でき、全てで性能向上

- コードと学習済モデルは一般公開予定



## 1. Introduction

現実における視覚的パターンはマルチスケールで発生する

→マルチスケールの刺激に対する優れた特徴を設計することが非常に重要

- オブジェクトは単一の画像内に異なるサイズで現れる
  - ソファとカップ
- オブジェクトの本質的な文脈情報は、オブジェクト自体よりもはるかに広い領域を占めることがある
  - 大きな黒いテーブルの上に置かれている小さな黒い塊がカップなのか、ペンホルダーなのかをより正確に区別するために、コンテキストとして大きなテーブルを使用する 
- さまざまなスケールからの情報を認識することは、部分だけでなく物体を認識するためには不可欠
  - 画像分類、物体検出、注意予測、目標追跡、行動認識、Segmentation、顕著オブジェクト検出

![キャプチャ](画像とか\キャプチャ.PNG)



マルチスケール表現：

- 異なるスケールでオブジェクト／パーツ／文脈を記述したい

  →広範囲の受容野を使用するための特徴抽出器が必要

- CNNはたたみ込み演算子のスタックを介してマルチスケールの特徴を自然に学習する

  - AlexNet、VGGNet

- CNNの性能をさらに向上させるに、レイヤ単位のマルチスケール表現の強度を向上させる

  - InceptionNets：カーネルサイズの異なるconv層を重ねる
  - ResNet：残差モジュール
  - DenseNet：ショートカット接続
  - DLA：階層化された層の集約



提案手法：効率的なマルチスケール処理アプローチ

- マルチスケール表現能力をより詳細なレベルで向上させる

- nチャネルの3×3フィルタを、各々がwチャネルを有するs個のフィルタグループと置き換える (n=sw)

- 各グループは階層的な残差スタイルで接続される（特徴を表現できるスケールの数を増やすため）

  → 3×3フィルタを通過するたびに等価受容野が増大し、組合せにより多くの等価特徴スケールが生じる

- 既存の次元（深さ、幅、濃度）に加えて、新しい次元「スケール」が重要

  - スケール：Res2Netブロック内のフィーチャグループの数
  - スケールを大きくする方が他の寸法を大きくするより効果的

- 既存のレイヤ単位操作ベースと異なり、より細かいレベルでマルチスケールの可能性を考えている

  →既存の方法とは独立し、多くの既存のCNNアーキテクチャに簡単に組み合わせられる

![キャプチャ2](画像とか\キャプチャ2.PNG)



## 2. 関連研究

#### 2.1 Backbone NW

- AlexNet
  - フィルタを順番に積み重ねて、マルチスケール特徴表現能力を備えた
- VGGNet
  - 大きなスケールから特徴を抽出するとき、大きなカーネルを使用するよりも多くのレイヤーを重ねることで受容野を広げる方が簡単であることを示した
  - 直列にフィルタをスタックするため、受容領域の柔軟性に欠けるが、小規模の処理に適する


- GoogLeNet 
  - 異なるカーネルサイズの並列フィルタを利用
  - 計算寮が多く、受容領域に限界があった
- Inception Nets
  - GoogLeNetの並列パスの各パスに、より多くのフィルタを積み重ねて、受容野を拡大
- ResNet
  - short connectionを導入し、深いネットワーク構造を得ながら勾配の消失を軽減
  - 畳み込み演算子の異なる組み合わせを可能にし、多数の等価な特徴スケールが得られる
- DenseNet
  - densely connected layersにより広範囲のスケールでオブジェクトを処理できる
- DPN
  - ResNetとDenseNetを組み合わせる（特徴再利用×特徴探索）
- DLA
  - hierarchical tree structureにより、さらに強力なレイヤ単位のマルチスケール表現を得る



#### 2.2 マルチスケール特徴表現

##### 物体検出

- R-CNN
  - Backborn NW（VGG net）の後で空間ピラミッドプーリング（SPP-Net）
- Faster R-CNN
  - 領域提案ネットワークで様々なスケールのバウンディングボックスを生成
- FPN
  - 特徴ピラミッド
- SSD
  - 異なる段階からの特徴マップを利用



##### Semantic Segmentation

- FCN
  - マルチスケールの特徴を捉える工夫によりSemantic Segmentationに利用可能に
- DeepLab
  - Cascaded Atras convolutionにより空間解像度を維持しながら受容野をさらに拡大
- PSPNet
  - Pyramid Poolongにより領域ごとの特徴から文脈を集約



##### Salient Object Detection (注目オブジェクト検出)

画像内の注目オブジェクト領域を特定する技術っぽい、要勉強

- オブジェクトの顕著性を判断

  →大規模なコンテキスト情報が必要

- オブジェクトの境界を正確に特定

  →小規模な特徴が必要

→マルチスケール特徴 + マルチコンテキスト

　→マルチレベルの畳み込み機能 + 各層における段階間で密な短い接続



## 3. Res2Net

#### 3.1 Res2Netモジュール

##### 概要

- DeepなBackborn NWの基本的な構成要素（ResNet、ResNeXt、DLA）であるボトルネック構造を代替する、より強力なマルチスケールの特徴抽出能力を持つ代替アーキテクチャである
- Residualブロック内にResidualっぽい接続を含むのでRes2Netとする
- スケール次元の制御パラメータs（= 分割数）が大きいほど強力なマルチスケール機能となる

![キャプチャ2](画像とか\キャプチャ2.PNG)



#####アーキテクチャ

1. 1x1の畳み込み
2. s個の特徴マップサブセットに均等に分割 (xi)
3. 3x3の畳み込み→次のグループの入力に足す
4. 1x1の畳み込みで情報を融合





#### 3.2 他のモジュールとの統合 

他のブロックと相性が良く実装も簡単

- 濃度
  - ResNeXtで使われている概念。複数パスを使い表現力を向上する（group convolution）
- SEブロック
  - チャネル間の相互依存性をモデル化し、チャネルごとの応答を較正




#### 3.3 Res2Netモジュールを統合したモデル

ResNet、ResNeXt、DLAに統合→Res2Net、Res2NeXt、Res2Net-DLA



## 4. 実験

#### 4.2 ~ 4.5 分類問題における検証

Res2Netは強い。

![キャプチャ3](画像とか\キャプチャ3.PNG)

深くしても強い。

![キャプチャ4](画像とか\キャプチャ4.PNG)

深くor広くするよりもscaleを大きくする方が強い。

![キャプチャ5](画像とか\キャプチャ5.PNG)

ので、計算量の割には高い精度を出すことができる。

![キャプチャ6](画像とか\キャプチャ6.PNG)

GradCAM結果。

- 大きいオブジェクトは全体にまんべんなく注目
- 小さいオブジェクトは一部のみに集中して注目

やばいね。

![キャプチャ7](画像とか\キャプチャ7.PNG)



#### 4.6 ~ 4.9 物体検出・セグメンテーション

大中小すべてのオブジェクトに対し適合率・再現率が向上



## 5. 結論と展望

- 単純でありながら効率的なブロックRes2Net
- 新しい次元「スケール」
- Res2Netモジュールは、既存の最先端の方法と簡単に統合できる
- より良いマルチスケール特徴を得ることができるようになった
- コードと学習済モデルは一般公開予定